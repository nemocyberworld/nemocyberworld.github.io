<!DOCTYPE html>
<html lang="en" class="dark h-full">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>NemoCyberWorld</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/monokai.min.css" rel="stylesheet" />
  <style>
    body { font-family: 'Fira Code', monospace; }
    pre code { white-space: pre-wrap; }
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-thumb { background: #4b5563; border-radius: 5px; }
  </style>
</head>
<body class="h-full bg-gray-900 text-white flex overflow-hidden">

  <!-- Sidebar -->
  <aside class="w-72 bg-gray-800 p-4 overflow-y-auto h-full border-r border-gray-700">
    <h1 class="text-2xl font-bold text-cyan-400 mb-6">üì¶ Nemo Repositories</h1>
    <nav id="repo-list" class="space-y-3 text-sm"></nav>
  </aside>

  <!-- Main Viewer -->
  <main class="flex-1 overflow-y-auto p-6">
    <div id="repo-content" class="prose prose-invert max-w-none">
      <h2 class="text-3xl text-cyan-400 font-bold">Welcome</h2>
      <p class="text-gray-300">Select a repository from the left to view its content, README, and files.</p>
    </div>
  </main>

  <script>
    const username = "nemocyberworld"; // üîÅ CHANGE THIS TO YOUR GITHUB USERNAME

    const repoList = document.getElementById('repo-list');
    const contentArea = document.getElementById('repo-content');

    function base64ToUtf8(base64) {
      try {
        return decodeURIComponent(escape(atob(base64)));
      } catch {
        return atob(base64);
      }
    }

    async function fetchRepos() {
      const res = await fetch(`https://api.github.com/users/${username}/repos`);
      const repos = await res.json();

      repos.forEach(repo => {
        const div = document.createElement('div');
        div.innerHTML = `
          <details>
            <summary class="cursor-pointer font-semibold text-white">${repo.name}</summary>
            <ul class="ml-4 mt-2 space-y-1">
              <li><a href="#" onclick="loadRepo('${repo.name}')" class="hover:underline">üìò View</a></li>
            </ul>
          </details>
        `;
        repoList.appendChild(div);
      });
    }

    async function loadRepo(repo) {
      contentArea.innerHTML = `<h2 class="text-xl text-cyan-400 mb-4">${repo}</h2><p class="text-gray-400">Loading...</p>`;

      try {
        const readmeRes = await fetch(`https://api.github.com/repos/${username}/${repo}/readme`);
        const readmeJson = await readmeRes.json();
        const markdown = base64ToUtf8(readmeJson.content);

        const filesRes = await fetch(`https://api.github.com/repos/${username}/${repo}/contents`);
        const files = await filesRes.json();

        const fileList = files.map(f => {
          if (f.type === "file") {
            return `<li><a href="#" onclick="loadFile('${repo}', '${f.path}')" class="text-cyan-300 hover:underline">${f.name}</a></li>`;
          } else {
            return `<li><span class="text-yellow-400">üìÅ ${f.name}</span></li>`;
          }
        }).join("");

        contentArea.innerHTML = `
          <h2 class="text-2xl font-bold text-cyan-400">${repo}</h2>
          <div class="mt-4">${marked.parse(markdown)}</div>
          <h3 class="text-xl mt-6 text-gray-300">üìÅ Files</h3>
          <ul class="list-disc list-inside space-y-1 text-sm mt-2">${fileList}</ul>
        `;
        hljs.highlightAll();
      } catch (e) {
        contentArea.innerHTML = `<p class="text-red-400">‚ùå Failed to load repository contents.</p>`;
        console.error(e);
      }
    }

    async function loadFile(repo, path) {
      contentArea.innerHTML = `<p class="text-gray-400">Loading file: <strong>${path}</strong>...</p>`;
      try {
        const fileRes = await fetch(`https://raw.githubusercontent.com/${username}/${repo}/main/${path}`);
        const content = await fileRes.text();

        const extension = path.split('.').pop();
        const lang = hljs.getLanguage(extension) ? extension : '';

        contentArea.innerHTML = `
          <h2 class="text-xl text-cyan-400 mb-2">${path}</h2>
          <pre><code class="language-${lang}">${content.replace(/</g, "&lt;").replace(/>/g, "&gt;")}</code></pre>
        `;
        hljs.highlightAll();
      } catch (err) {
        contentArea.innerHTML = `<p class="text-red-400">‚ö†Ô∏è Unable to load this file.</p>`;
        console.error(err);
      }
    }

    fetchRepos();
  </script>
</body>
</html>
